# Cross-Site Request Forgery (CSRF)

## Attack tree

```text
1 Find a relevant action (change password or email, etc) (AND)
2 Send request to site
    2.1 Create valid request (AND)
        2.1.1 Analyse real requests of the site (right-click and inspect element) (AND)
        2.1.2 Use XSS to get session token in use by site (OR)
        2.1.3 Create a forged form request (login CSRF)
            2.1.3.1 Analyse html form (AND)
            2.1.3.2 Forge html form
        2.1.4 Create a request forging the HTTP Referrer attribute (OR)
            2.1.4.1 Analyse real requests of the site (AND)
            2.1.4.2 Forge HTTP request with Flash (OR)
            2.1.4.3 Forge HTTP request with XMLHTTPRequest 
    2.2 Social engineering
```

## Notes

Cross-site scripting (XSS) exploits the trust a user has in a particular site, CSRF exploits the trust a site has in a 
user's browser.

* Requests are not validated server-side
* Server does not check whether request was generated by user
* Requests can be forged and sent to users (to make the server data leakage, change a session state, or manipulate a user's account)

CSRF will be possible if the session relies only on cookies or on HTTP Basic Authentication header, and there are no 
unpredictable parameters on the request.

## Cheatsheets

* [CSRF Attack vectors](cheatsheets:docs/application/csrf)